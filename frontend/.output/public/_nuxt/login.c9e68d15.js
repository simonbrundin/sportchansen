import{_ as C}from"./nuxt-link.d2ed2ec8.js";import{a as M,b as c,e as g,f as D,r as f,o as V,h as $,i as P,w as v,v as I,u as i,j as u,k as x,l as _,m as h,t as R,p as b,q as A,s as K,x as N,y as B,z as F}from"./entry.0447124f.js";import{u as p}from"./auth.8d4b1157.js";M();const T=async(o,l)=>{const{error:e,session:t}=await c.auth.signUp({email:o,password:l});if(e)throw e;if(!t)throw g("/auth/verify"),"User needs to verify email";return g("/"),t},W=async(o,l)=>{console.log("Start signUp");try{await T(o,l);const e=p();e.signInErrorMessage="";return}catch(e){const t=p();t.signInErrorMessage=e.message}};M();const j=()=>c.auth.isAuthenticated(),q=async(o,l)=>{const{error:e,session:t}=await c.auth.signIn({email:o,password:l});if(e)throw e;if(!t)throw g("/auth/verify"),"User needs to verify email";return g("/"),t},E=async(o,l)=>{if(j())return g("/"),"Successful login";try{await W(o,l);return}catch{}if(l)try{await q(o,l);const e=p();e.signInErrorMessage="";return}catch(e){const t=p();t.signInErrorMessage=e.message}},z=""+new URL("google-logo.b0b9055a.png",import.meta.url).href,S=o=>(N("data-v-0268081e"),o=o(),B(),o),G={class:"flex flex-col gap-4"},H=S(()=>u("img",{src:z,class:"w-4",srcset:""},null,-1)),J=S(()=>u("div",null,"Fortsätt med Google",-1)),O=[H,J],Q=D({__name:"login",setup(o){(async()=>{await(()=>c.auth.isAuthenticatedAsync())()&&g("/")})();const e=f(""),t=f(""),y=f(!1);f(!0);const w=f(!1),d=p(),k=async(n,s)=>{const{error:a,session:r}=await c.auth.signUp({email:n,password:s});if(a)throw a.status===409?(d.signInErrorMessage="",a):(d.signInErrorMessage=a.message,a);if(!r)throw g("/auth/verify"),d.signInErrorMessage="Du behöver verifiera din epostadress","Du behöver verifiera din epostadress";return g("/"),d.signInErrorMessage="",r},U=async(n,s)=>{const{error:a,session:r}=await c.auth.signIn({email:n,password:s});if(a)throw a.status===401&&(y.value=!0,w.value=!0),d.signInErrorMessage=a.message,a;if(!r)throw g("/auth/verify"),d.signInErrorMessage="Du behöver verifiera din epostadress","Du behöver verifiera din epostadress";return g("/"),d.signInErrorMessage="",r},m=()=>{if(!t.value){y.value=!0;return}try{k(e.value,t.value),U(e.value,t.value)}catch{}},L=async()=>{const{error:n}=await c.auth.resetPassword({email:e.value});if(n)throw d.signInErrorMessage=n.message,n;d.signInErrorMessage="Kolla din epost för att återställa lösenordet"};return(n,s)=>{const a=C;return V(),$("div",G,[P("",!0),v(u("input",{type:"email",name:"email","onUpdate:modelValue":s[0]||(s[0]=r=>x(e)?e.value=r:null),onKeyup:s[1]||(s[1]=_(r=>m(),["enter"])),autofocus:"",placeholder:"Epostadress",class:"px-4 py-4 rounded-lg text-gray-700"},null,544),[[I,i(e)]]),v(u("input",{type:"password",name:"password","onUpdate:modelValue":s[2]||(s[2]=r=>x(t)?t.value=r:null),onKeyup:s[3]||(s[3]=_(r=>m(),["enter"])),autofocus:"",placeholder:"Lösenord",class:"px-4 py-4 rounded-lg text-gray-700"},null,544),[[h,i(y)],[I,i(t)]]),u("button",{onClick:s[4]||(s[4]=r=>m()),class:"bg-blue-500 px-4 py-4 rounded-lg text-slate-50"}," Fortsätt "),v(u("button",{onClick:s[5]||(s[5]=r=>("signIn"in n?n.signIn:i(E))(i(e))),class:"bg-slate-700 px-4 py-4 rounded-lg text-slate-50"}," Fortsätt med Passkey ",512),[[h,!1]]),v(u("div",{class:"text-slate-700 bg-red-200 border-red-300 border-4 p-4 rounded-lg"},R(i(p)().signInErrorMessage),513),[[h,i(p)().signInErrorMessage]]),v(u("div",{onClick:s[6]||(s[6]=r=>L()),class:"text-white"}," Återställ lösenord ",512),[[h,i(w)]]),u("button",{onClick:s[7]||(s[7]=r=>("signIn"in n?n.signIn:i(E))(i(e),i(t))),class:"bg-slate-700 px-4 py-4 rounded-lg text-slate-50 grid google-button items-center"},O),u("div",null,[b(" Saknar du ett konto? "),A(a,{to:"/auth/register",class:"text-blue-500"},{default:K(()=>[b("Registera")]),_:1})])])}}});const ee=F(Q,[["__scopeId","data-v-0268081e"]]);export{ee as default};
